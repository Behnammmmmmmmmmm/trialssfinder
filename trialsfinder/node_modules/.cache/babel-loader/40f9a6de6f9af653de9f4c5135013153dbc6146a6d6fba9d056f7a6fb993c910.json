{"ast":null,"code":"import React,{useEffect,useState,useCallback}from'react';import{useSearchParams}from'react-router-dom';import{analyticsAPI}from'../api/analytics';import{trialsAPI}from'../api/trials';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const AnalyticsPage=()=>{const[searchParams]=useSearchParams();const[trials,setTrials]=useState([]);const[selectedTrial,setSelectedTrial]=useState(null);const[dateRange,setDateRange]=useState({start_date:'',end_date:''});const[metrics,setMetrics]=useState(null);const loadMetrics=useCallback(async()=>{if(!selectedTrial){return;}try{const response=await analyticsAPI.getTrialMetrics(selectedTrial,dateRange);setMetrics(response.data);}catch(error){console.error('Failed to load metrics:',error);}},[selectedTrial,dateRange]);useEffect(()=>{loadTrials();const trialId=searchParams.get('trial');if(trialId){setSelectedTrial(parseInt(trialId));}},[searchParams]);useEffect(()=>{if(selectedTrial){loadMetrics();}},[selectedTrial,dateRange,loadMetrics]);const loadTrials=async()=>{try{const response=await trialsAPI.companyTrials();// Handle both paginated and non-paginated responses\nconst trialsData=response.data.results||response.data;setTrials(Array.isArray(trialsData)?trialsData:[]);}catch(error){console.error('Failed to load trials:',error);setTrials([]);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Analytics Dashboard\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"select\",{value:selectedTrial||'',onChange:e=>setSelectedTrial(e.target.value?parseInt(e.target.value):null),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a trial\"}),trials.map(trial=>/*#__PURE__*/_jsx(\"option\",{value:trial.id,children:trial.title},trial.id))]}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:dateRange.start_date,onChange:e=>setDateRange({...dateRange,start_date:e.target.value})}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:dateRange.end_date,onChange:e=>setDateRange({...dateRange,end_date:e.target.value})})]}),metrics&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Summary Stats\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Views: \",metrics.views]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Clicks: \",metrics.clicks]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Conversions: \",metrics.conversions.toFixed(2),\"%\"]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Weekly Chart\"}),metrics.weekly_data.map(day=>/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"span\",{children:[day.date,\": Views: \",day.views,\", Clicks: \",day.clicks]})},day.date)),/*#__PURE__*/_jsx(\"h2\",{children:\"Monthly Chart\"}),metrics.monthly_data.map(day=>/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"span\",{children:[day.date,\": Events: \",day.events]})},day.date))]})]});};export default AnalyticsPage;","map":{"version":3,"names":["React","useEffect","useState","useCallback","useSearchParams","analyticsAPI","trialsAPI","jsx","_jsx","jsxs","_jsxs","AnalyticsPage","searchParams","trials","setTrials","selectedTrial","setSelectedTrial","dateRange","setDateRange","start_date","end_date","metrics","setMetrics","loadMetrics","response","getTrialMetrics","data","error","console","loadTrials","trialId","get","parseInt","companyTrials","trialsData","results","Array","isArray","children","value","onChange","e","target","map","trial","id","title","type","views","clicks","conversions","toFixed","weekly_data","day","date","monthly_data","events"],"sources":["C:/Users/behna/Desktop/trialssfinder/trialsfinder/src/pages/AnalyticsPage.tsx"],"sourcesContent":["import React, { useEffect, useState, useCallback } from 'react';\r\nimport { useSearchParams } from 'react-router-dom';\r\nimport { analyticsAPI } from '../api/analytics';\r\nimport { trialsAPI } from '../api/trials';\r\nimport { Trial } from '../types';\r\n\r\nexport const AnalyticsPage: React.FC = () => {\r\n  const [searchParams] = useSearchParams();\r\n  const [trials, setTrials] = useState<Trial[]>([]);\r\n  const [selectedTrial, setSelectedTrial] = useState<number | null>(null);\r\n  const [dateRange, setDateRange] = useState({\r\n    start_date: '',\r\n    end_date: ''\r\n  });\r\n  const [metrics, setMetrics] = useState<any>(null);\r\n\r\n  const loadMetrics = useCallback(async () => {\r\n    if (!selectedTrial) {\r\n      return;\r\n    }\r\n    try {\r\n      const response = await analyticsAPI.getTrialMetrics(selectedTrial, dateRange);\r\n      setMetrics(response.data);\r\n    } catch (error) {\r\n      console.error('Failed to load metrics:', error);\r\n    }\r\n  }, [selectedTrial, dateRange]);\r\n\r\n  useEffect(() => {\r\n    loadTrials();\r\n    const trialId = searchParams.get('trial');\r\n    if (trialId) {\r\n      setSelectedTrial(parseInt(trialId));\r\n    }\r\n  }, [searchParams]);\r\n\r\n  useEffect(() => {\r\n    if (selectedTrial) {\r\n      loadMetrics();\r\n    }\r\n  }, [selectedTrial, dateRange, loadMetrics]);\r\n\r\n  const loadTrials = async () => {\r\n    try {\r\n      const response = await trialsAPI.companyTrials();\r\n      // Handle both paginated and non-paginated responses\r\n      const trialsData = response.data.results || response.data;\r\n      setTrials(Array.isArray(trialsData) ? trialsData : []);\r\n    } catch (error) {\r\n      console.error('Failed to load trials:', error);\r\n      setTrials([]);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h1>Analytics Dashboard</h1>\r\n\r\n      <div>\r\n        <select \r\n          value={selectedTrial || ''} \r\n          onChange={(e) => setSelectedTrial(e.target.value ? parseInt(e.target.value) : null)}\r\n        >\r\n          <option value=\"\">Select a trial</option>\r\n          {trials.map(trial => (\r\n            <option key={trial.id} value={trial.id}>{trial.title}</option>\r\n          ))}\r\n        </select>\r\n\r\n        <input\r\n          type=\"date\"\r\n          value={dateRange.start_date}\r\n          onChange={(e) => setDateRange({...dateRange, start_date: e.target.value})}\r\n        />\r\n        <input\r\n          type=\"date\"\r\n          value={dateRange.end_date}\r\n          onChange={(e) => setDateRange({...dateRange, end_date: e.target.value})}\r\n        />\r\n      </div>\r\n\r\n      {metrics && (\r\n        <div>\r\n          <h2>Summary Stats</h2>\r\n          <p>Views: {metrics.views}</p>\r\n          <p>Clicks: {metrics.clicks}</p>\r\n          <p>Conversions: {metrics.conversions.toFixed(2)}%</p>\r\n\r\n          <h2>Weekly Chart</h2>\r\n          {metrics.weekly_data.map((day: any) => (\r\n            <div key={day.date}>\r\n              <span>{day.date}: Views: {day.views}, Clicks: {day.clicks}</span>\r\n            </div>\r\n          ))}\r\n\r\n          <h2>Monthly Chart</h2>\r\n          {metrics.monthly_data.map((day: any) => (\r\n            <div key={day.date}>\r\n              <span>{day.date}: Events: {day.events}</span>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AnalyticsPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}