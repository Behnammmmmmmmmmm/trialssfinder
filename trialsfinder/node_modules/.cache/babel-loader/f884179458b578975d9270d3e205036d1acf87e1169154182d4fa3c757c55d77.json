{"ast":null,"code":"import React,{useEffect,useState,useCallback,useMemo,lazy,Suspense}from'react';import{Link,useNavigate}from'react-router-dom';import{useTrials,useAuth}from'../hooks/useStore';import{LoadingState}from'../components/LoadingState';// Lazy load heavy components\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TrialCard=/*#__PURE__*/lazy(()=>import(/* webpackPrefetch: true */'../components/TrialCard'));// Debounce without lodash\nconst debounce=(func,delay)=>{let timeoutId;return function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}clearTimeout(timeoutId);timeoutId=setTimeout(()=>func(...args),delay);};};// Simple card skeleton\nconst CardSkeleton=()=>/*#__PURE__*/_jsx(\"div\",{className:\"card\",style:{minHeight:'320px'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"skeleton h-6 w-3/4 mb-3\"}),/*#__PURE__*/_jsx(\"div\",{className:\"skeleton h-4 w-full mb-2\"}),/*#__PURE__*/_jsx(\"div\",{className:\"skeleton h-4 w-5/6 mb-4\"}),/*#__PURE__*/_jsx(\"div\",{className:\"skeleton h-10 w-full\"})]})});// Hero section as separate component\nconst HeroSection=/*#__PURE__*/React.memo(()=>{const[searchQuery,setSearchQuery]=useState('');const navigate=useNavigate();const debouncedSearch=useMemo(()=>debounce(query=>{if(query.length>2){navigate(`/search?q=${encodeURIComponent(query)}`);}},500),[navigate]);const handleSearchChange=useCallback(e=>{const value=e.target.value;setSearchQuery(value);debouncedSearch(value);},[debouncedSearch]);return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-12\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-5xl font-bold mb-6 text-primary\",children:\"Find Your Perfect Trial\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl text-muted mb-8\",children:\"Discover free trials for the tools and services your business needs\"}),/*#__PURE__*/_jsx(\"div\",{className:\"max-w-full mx-auto mb-8\",style:{maxWidth:'600px'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"search-trials\",className:\"sr-only\",children:\"Search trials\"}),/*#__PURE__*/_jsx(\"input\",{id:\"search-trials\",type:\"search\",value:searchQuery,onChange:handleSearchChange,placeholder:\"Search trials...\",className:\"form-control form-control-lg px-6\",style:{paddingLeft:'3rem'},\"aria-label\":\"Search for clinical trials\",autoComplete:\"off\"}),/*#__PURE__*/_jsx(\"span\",{className:\"search-icon\",\"aria-hidden\":\"true\",children:\"\\uD83D\\uDD0D\"})]})}),/*#__PURE__*/_jsx(Link,{to:\"/search\",className:\"btn\",\"data-variant\":\"outline\",\"data-size\":\"lg\",children:\"Browse All Trials\"})]});});HeroSection.displayName='HeroSection';const HomePage=()=>{const{trials,fetchTrials,loadingTrials}=useTrials();const{mockMode}=useAuth();// Get mockMode from auth state\nconst[visibleTrials,setVisibleTrials]=useState(6);const[initialLoad,setInitialLoad]=useState(true);useEffect(()=>{// Fetch only what's needed initially\nconst loadInitialData=async()=>{if(!mockMode){// Only fetch if not in mock mode\nawait fetchTrials({page_size:12});}setInitialLoad(false);};loadInitialData();},[fetchTrials,mockMode]);const trialsArray=useMemo(()=>Array.isArray(trials)?trials:[],[trials]);const{featuredTrials,latestTrials}=useMemo(()=>{const featured=[];const latest=[];trialsArray.forEach(trial=>{if(trial.is_featured){featured.push(trial);}else{latest.push(trial);}});return{featuredTrials:featured.slice(0,visibleTrials),latestTrials:latest.slice(0,visibleTrials)};},[trialsArray,visibleTrials]);// Load more trials on scroll\nuseEffect(()=>{const handleScroll=()=>{if(window.innerHeight+window.scrollY>=document.body.offsetHeight-1000){setVisibleTrials(prev=>Math.min(prev+6,trialsArray.length));}};window.addEventListener('scroll',handleScroll,{passive:true});return()=>window.removeEventListener('scroll',handleScroll);},[trialsArray.length]);if(loadingTrials&&initialLoad){return/*#__PURE__*/_jsx(LoadingState,{fullScreen:true,message:\"Loading trials...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container py-8\",children:[/*#__PURE__*/_jsx(HeroSection,{}),mockMode&&/*#__PURE__*/_jsxs(\"div\",{className:\"alert mb-4\",\"data-variant\":\"warning\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold\",children:\"Development Mode\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:\"Backend is not available. Using mock data.\"})]}),featuredTrials.length>0&&/*#__PURE__*/_jsxs(\"section\",{className:\"mb-12\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-semibold mb-6\",children:\"Featured Free Trials\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\",children:featuredTrials.map((trial,index)=>/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(CardSkeleton,{}),children:/*#__PURE__*/_jsx(TrialCard,{trial:trial,featured:true,priority:index<3})},trial.id))})]}),latestTrials.length>0&&/*#__PURE__*/_jsxs(\"section\",{className:\"mb-12\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-semibold mb-6\",children:\"Latest Free Trials\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\",children:latestTrials.map(trial=>/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(CardSkeleton,{}),children:/*#__PURE__*/_jsx(TrialCard,{trial:trial,featured:false,priority:false})},trial.id))})]}),trialsArray.length===0&&!loadingTrials&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-6xl mb-4\",\"aria-hidden\":\"true\",children:\"\\uD83D\\uDD0D\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl text-muted\",children:\"No trials available at the moment.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg text-muted\",children:\"Check back soon for new opportunities!\"})]})]});};export default HomePage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}