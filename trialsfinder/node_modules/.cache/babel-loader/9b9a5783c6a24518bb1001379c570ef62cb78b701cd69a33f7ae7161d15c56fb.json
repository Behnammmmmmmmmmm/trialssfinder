{"ast":null,"code":"import React,{useEffect,useState,useCallback}from'react';import{useSearchParams}from'react-router-dom';import{analyticsAPI}from'../api/analytics';import{trialsAPI}from'../api/trials';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const AnalyticsPage=()=>{const[searchParams]=useSearchParams();const[trials,setTrials]=useState([]);const[selectedTrial,setSelectedTrial]=useState(null);const[dateRange,setDateRange]=useState({start_date:'',end_date:''});const[metrics,setMetrics]=useState(null);const loadMetrics=useCallback(async()=>{if(!selectedTrial){return;}try{const response=await analyticsAPI.getTrialMetrics(selectedTrial,dateRange);setMetrics(response.data);}catch(error){console.error('Failed to load metrics:',error);}},[selectedTrial,dateRange]);useEffect(()=>{loadTrials();const trialId=searchParams.get('trial');if(trialId){setSelectedTrial(parseInt(trialId));}},[searchParams]);useEffect(()=>{if(selectedTrial){loadMetrics();}},[selectedTrial,dateRange,loadMetrics]);const loadTrials=async()=>{try{const response=await trialsAPI.companyTrials();// Handle both paginated and non-paginated responses\nconst trialsData=response.data.results||response.data;setTrials(Array.isArray(trialsData)?trialsData:[]);}catch(error){console.error('Failed to load trials:',error);setTrials([]);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Analytics Dashboard\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"select\",{value:selectedTrial||'',onChange:e=>setSelectedTrial(e.target.value?parseInt(e.target.value):null),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a trial\"}),trials.map(trial=>/*#__PURE__*/_jsx(\"option\",{value:trial.id,children:trial.title},trial.id))]}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:dateRange.start_date,onChange:e=>setDateRange({...dateRange,start_date:e.target.value})}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:dateRange.end_date,onChange:e=>setDateRange({...dateRange,end_date:e.target.value})})]}),metrics&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Summary Stats\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Views: \",metrics.views]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Clicks: \",metrics.clicks]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Conversions: \",metrics.conversions.toFixed(2),\"%\"]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Weekly Chart\"}),metrics.weekly_data.map(day=>/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"span\",{children:[day.date,\": Views: \",day.views,\", Clicks: \",day.clicks]})},day.date)),/*#__PURE__*/_jsx(\"h2\",{children:\"Monthly Chart\"}),metrics.monthly_data.map(day=>/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"span\",{children:[day.date,\": Events: \",day.events]})},day.date))]})]});};export default AnalyticsPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}