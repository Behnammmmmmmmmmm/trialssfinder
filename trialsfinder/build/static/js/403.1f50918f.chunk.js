(self.webpackChunktrialsfinder=self.webpackChunktrialsfinder||[]).push([[403],{1098:(e,t,r)=>{r.d(t,{K:()=>n});var a=r(6869);const n={list:e=>a.Ay.get("/trials/",{params:e}),get:e=>a.Ay.get(`/trials/${e}/`),create:e=>a.Ay.post("/trials/create/",e),companyTrials:()=>a.Ay.get("/trials/company/"),toggleFavorite:e=>a.Ay.post(`/trials/${e}/favorite/`),getFavorites:()=>a.Ay.get("/trials/favorites/"),getIndustries:()=>a.Ay.get("/trials/industries/"),followIndustries:e=>a.Ay.post("/trials/industries/follow/",{industries:e}),getUserIndustries:()=>a.Ay.get("/trials/industries/user/"),approveTrial:e=>a.Ay.post(`/trials/${e}/approve/`),toggleFeatured:e=>a.Ay.post(`/trials/${e}/toggle-featured/`),adminList:()=>a.Ay.get("/trials/admin/")}},3981:(e,t,r)=>{r.d(t,{B:()=>u});var a=r(9846),n=r(3446),i=r(5827),s=r(4985),o=r(5472),l=r(888),c=r(3207),d=r(2389);const h={en:s.c,es:o.es,fr:l.fr,de:i.de,ar:n.ar,he:c.he},u=()=>{const{t:e,i18n:t}=(0,d.Bd)();return{t:e,i18n:t,formatDate:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"PP";const n=h[t.language]||s.c;return(0,a.GP)(new Date(e),r,{locale:n})},formatCurrency:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD";return new Intl.NumberFormat(t.language,{style:"currency",currency:r}).format(e)},formatNumber:e=>new Intl.NumberFormat(t.language).format(e),isRTL:["ar","he"].includes(t.language)}}},6323:(e,t,r)=>{r.d(t,{n:()=>n});var a=r(6869);const n={list:()=>a.Ay.get("/notifications/"),markRead:e=>a.Ay.post(`/notifications/${e}/read/`),contact:e=>a.Ay.post("/notifications/contact/",e)}},6869:(e,t,r)=>{r.d(t,{Ay:()=>o});var a=r(1083);const n=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.cache=new Map,this.pendingRequests=new Map,this.maxSize=e.max||500,this.defaultTTL=e.ttl||3e5}generateKey(e,t){return`${e}:${t?JSON.stringify(t,Object.keys(t).sort()):""}`}isExpired(e){return Date.now()>e.expiry}evictOldest(){if(this.cache.size>=this.maxSize){const e=this.cache.keys().next().value;e&&this.cache.delete(e)}}get(e){const t=this.cache.get(e);if(t)return this.isExpired(t)?(this.cache.delete(e),void 0):t.data}set(e,t,r){this.evictOldest();const a=Date.now()+(r||this.defaultTTL);this.cache.set(e,{data:t,expiry:a})}async getOrFetch(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=this.generateKey(e,r.params),n=this.get(a);if(void 0!==n)return n;const i=this.pendingRequests.get(a);if(i)return i;const s=t().then(e=>(this.set(a,e,r.ttl),this.pendingRequests.delete(a),e)).catch(e=>{throw this.pendingRequests.delete(a),e});return this.pendingRequests.set(a,s),s}invalidate(e){if(!e)return this.cache.clear(),void 0;for(const t of Array.from(this.cache.keys()))t.includes(e)&&this.cache.delete(t)}invalidateUser(e){this.invalidate(`user:${e}`)}invalidateTrial(e){this.invalidate(`trial:${e}`),this.invalidate("trials:")}},i="/api",s=a.A.create({baseURL:i,headers:{common:{"Content-Type":"application/json"}},withCredentials:!0,timeout:3e4});(e=>{if(!e||!e.interceptors)return void 0,void 0;e.interceptors.request.use(e=>{if("get"===e.method&&!1!==e.cache){const t=n.generateKey(e.url,e.params),r=n.get(t);r&&(e.adapter=()=>Promise.resolve({data:r,status:200,statusText:"OK",headers:{"x-cache":"HIT"},config:e}))}return e}),e.interceptors.response.use(e=>{if("get"===e.config.method&&200===e.status&&!1!==e.config.cache){const t=n.generateKey(e.config.url,e.config.params);n.set(t,e.data,e.config.cacheTTL)}return e})})(s),s.interceptors.request.use(e=>{const t=localStorage.getItem("access_token");if(t&&(e.headers.Authorization=`Bearer ${t}`),"get"!==e.method){const t=function(e){let t=null;if(document.cookie&&""!==document.cookie){const r=document.cookie.split(";");for(let a=0;a<r.length;a++){const n=r[a].trim();if(n.substring(0,10)===e+"="){t=decodeURIComponent(n.substring(10));break}}}return t}("csrftoken");t&&(e.headers["X-CSRFToken"]=t)}return e.headers["X-Requested-With"]="XMLHttpRequest",e}),s.interceptors.response.use(e=>e,async e=>{const t=e.config;if(!e.response)return 0,Promise.reject(e);if(401===e.response?.status&&!t._retry){t._retry=!0;try{const e=localStorage.getItem("refresh_token");if(!e)throw new Error("No refresh token");const r=await a.A.post(`${i}/auth/refresh/`,{refresh:e});return localStorage.setItem("access_token",r.data.access),s.defaults.headers.common.Authorization=`Bearer ${r.data.access}`,s(t)}catch(r){return n.invalidate(""),localStorage.clear(),1,window.location.href="/login",Promise.reject(e)}}return Promise.reject(e)});const o=s},7403:(e,t,r)=>{function a(e,t){switch(t.type){case"SET_USER":return{...e,user:t.payload};case"SET_TRIALS":return{...e,trials:t.payload};case"ADD_TRIAL":return{...e,trials:[...e.trials,t.payload]};case"UPDATE_TRIAL":return{...e,trials:e.trials.map(e=>e.id===t.payload.id?{...e,...t.payload.trial}:e)};case"SET_NOTIFICATIONS":return{...e,notifications:t.payload};case"MARK_NOTIFICATION_READ":return{...e,notifications:e.notifications.map(e=>e.id===t.payload?{...e,is_read:!0}:e)};case"SET_LOADING":return{...e,loading:{...e.loading,[t.payload.key]:t.payload.value}};case"SET_ERROR":return{...e,errors:t.payload.error?{...e.errors,[t.payload.key]:t.payload.error}:Object.fromEntries(Object.entries(e.errors).filter(e=>{let[r]=e;return r!==t.payload.key}))};case"CLEAR_ERRORS":return{...e,errors:{}};default:return e}}r.r(t),r.d(t,{default:()=>K});var n=r(5299),i=r(4976),s=r(7767),o=r(1083);class l extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown_error",r=arguments.length>2?arguments[2]:void 0;super(e),this.name="TrialsFinderError",this.code=t,this.details=r}}const c=(e,t)=>{const r=(e=>{if(o.A.isAxiosError(e)){const t=e;if(t.response?.data?.error){const e=t.response.data.error;return new l(e.message,e.code,e.details)}return"ECONNABORTED"===t.code?new l("Request timeout","timeout_error"):"ERR_NETWORK"===t.code?new l("Network error","network_error"):t.response?new l(t.message||"Request failed","request_error"):new l("Network error","network_error")}return e instanceof l?e:e instanceof Error?new l(e.message,"client_error"):new l("An unexpected error occurred","unknown_error")})(e);0,window.logger&&window.logger.error("Application error",{error:r,context:t})};var d=r(2240);class h extends n.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){void 0,c(e,"React Error Boundary")}resetError=()=>{this.setState({hasError:!1,error:null})};render(){return this.state.hasError&&this.state.error?this.props.fallback?this.props.fallback(this.state.error,this.resetError):(0,d.Y)("div",{className:"min-h-screen flex items-center justify-center",children:(0,d.Y)("div",{className:"card max-w-md",children:(0,d.FD)("div",{className:"card-body text-center",children:[(0,d.Y)("div",{className:"text-6xl mb-4",children:"\u26a0\ufe0f"}),(0,d.Y)("h2",{className:"text-2xl font-bold mb-4",children:"Something went wrong"}),(0,d.Y)("p",{className:"text-muted mb-6",children:"We're sorry for the inconvenience. Please try refreshing the page."}),(0,d.Y)("button",{onClick:this.resetError,className:"btn","data-variant":"primary",children:"Try again"}),!1]})})}):this.props.children}}var u=r(9098),m=r(2635),g=r(2389),f=r(7725);const p={en:{name:"English",dir:"ltr"},es:{name:"Espa\xf1ol",dir:"ltr"},fr:{name:"Fran\xe7ais",dir:"ltr"},de:{name:"Deutsch",dir:"ltr"},ar:{name:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",dir:"rtl"},he:{name:"\u05e2\u05d1\u05e8\u05d9\u05ea",dir:"rtl"}},y={type:"backend",init:function(){},read:function(e,t,r){const a=`/locales/${e}/${t}.json`;fetch(a).then(e=>{if(!e.ok)throw new Error(`Failed to load ${a}`);return e.json()}).then(e=>{r(null,e)}).catch(e=>{r(e,null)})}};void m.Ay.use(y).use(f.A).use(g.r9).init({fallbackLng:"en",debug:!1,interpolation:{escapeValue:!1},detection:{order:["cookie","localStorage","navigator","htmlTag"],caches:["cookie","localStorage"]},react:{useSuspense:!1}});var v=r(3981);const Y=()=>{const{i18n:e}=(0,v.B)();return(0,d.FD)("div",{className:"language-selector",children:[(0,d.Y)("label",{htmlFor:"language-select",className:"sr-only",children:"Choose language"}),(0,d.Y)("select",{id:"language-select",value:e.language,onChange:async t=>{const r=t.target.value;await e.changeLanguage(r),document.documentElement.dir=p[r].dir,document.documentElement.lang=r;const a=localStorage.getItem("access_token");a&&void fetch("/api/auth/language/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({language:r})})},className:"form-select","aria-label":"Select language",children:Object.entries(p).map(e=>{let[t,{name:r}]=e;return(0,d.Y)("option",{value:t,children:r},t)})})]})},k=e=>{let{children:t}=e;const{user:r,logout:a}=(0,u.As)(),n=(0,s.Zp)(),o=()=>{n("company"===r?.user_type?"/dashboard":"admin"===r?.user_type?"/admin":"/profile")};return(0,d.FD)("div",{className:"page-container",children:[(0,d.Y)("a",{href:"#main",className:"skip-link",children:"Skip to main content"}),(0,d.Y)("header",{className:"header",role:"banner",children:(0,d.FD)("div",{className:"header-container container",children:[(0,d.Y)(i.N_,{to:"/",className:"text-xl font-bold text-primary","aria-label":"TrialsFinder Home",children:"TrialsFinder"}),(0,d.FD)("nav",{className:"header-nav",role:"navigation","aria-label":"Main navigation",children:[(0,d.Y)(Y,{}),r?(0,d.FD)("div",{className:"flex items-center gap-4",children:[(0,d.Y)("button",{onClick:o,onKeyPress:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),o())},className:"cursor-pointer text-primary font-medium transition-colors hover:text-primary-dark focus:outline-2 focus:outline-primary focus:outline-offset-2 px-2 py-1 rounded","aria-label":`User menu for ${r.email}`,children:r.email}),(0,d.Y)(i.N_,{to:"/privacy-dashboard",className:"header-nav-item","aria-label":"Privacy Settings",children:"Privacy Settings"}),(0,d.Y)("button",{onClick:()=>{a(),n("/")},className:"btn","data-variant":"ghost","data-size":"sm","aria-label":"Sign out of your account",children:"Sign Out"})]}):(0,d.FD)("div",{className:"flex items-center gap-4",children:[(0,d.Y)(i.N_,{to:"/login",className:"header-nav-item","aria-label":"Login to your account",children:"Login"}),(0,d.Y)(i.N_,{to:"/register",className:"btn","data-variant":"primary","data-size":"sm","aria-label":"Create a new account",children:"Register"})]})]})]})}),(0,d.Y)("main",{id:"main",className:"main-content",role:"main",children:(0,d.Y)("div",{className:"container",children:t})}),(0,d.Y)("footer",{className:"footer",role:"contentinfo",children:(0,d.FD)("div",{className:"container",children:[(0,d.FD)("div",{className:"footer-content",children:[(0,d.FD)("div",{className:"footer-section",children:[(0,d.Y)("h2",{id:"footer-resources",children:"Resources"}),(0,d.Y)("nav",{"aria-labelledby":"footer-resources",children:(0,d.FD)("ul",{className:"footer-links",role:"list",children:[(0,d.Y)("li",{children:(0,d.Y)(i.N_,{to:"/faq",className:"footer-link",children:"FAQ"})}),(0,d.Y)("li",{children:(0,d.Y)(i.N_,{to:"/contact",className:"footer-link",children:"Contact"})}),(0,d.Y)("li",{children:(0,d.Y)(i.N_,{to:"/about",className:"footer-link",children:"About"})})]})})]}),(0,d.FD)("div",{className:"footer-section",children:[(0,d.Y)("h2",{id:"footer-legal",children:"Legal"}),(0,d.Y)("nav",{"aria-labelledby":"footer-legal",children:(0,d.FD)("ul",{className:"footer-links",role:"list",children:[(0,d.Y)("li",{children:(0,d.Y)(i.N_,{to:"/terms",className:"footer-link",children:"Terms"})}),(0,d.Y)("li",{children:(0,d.Y)(i.N_,{to:"/privacy",className:"footer-link",children:"Privacy"})})]})})]})]}),(0,d.Y)("div",{className:"footer-bottom",children:(0,d.Y)("p",{className:"text-muted text-sm",children:"\xa9 2024 TrialsFinder. All rights reserved."})})]})})]})},b={user:null,trials:[],notifications:[],loading:{},errors:{}},N=(0,n.createContext)(null),S=e=>{let{children:t}=e;const[r,i]=(0,n.useReducer)(a,b);return(0,d.Y)(N.Provider,{value:{state:r,dispatch:i},children:t})},T=(0,n.lazy)(()=>Promise.all([r.e(244),r.e(289)]).then(r.bind(r,2289))),w=(0,n.lazy)(()=>r.e(115).then(r.bind(r,4115))),_=(0,n.lazy)(()=>r.e(762).then(r.bind(r,8762))),A=(0,n.lazy)(()=>r.e(711).then(r.bind(r,711))),I=(0,n.lazy)(()=>Promise.all([r.e(583),r.e(70)]).then(r.bind(r,5070))),E=(0,n.lazy)(()=>r.e(192).then(r.bind(r,4192))),F=(0,n.lazy)(()=>r.e(499).then(r.bind(r,2499))),R=(0,n.lazy)(()=>Promise.all([r.e(244),r.e(487)]).then(r.bind(r,487)).then(e=>({default:e.PrivateRoute}))),x=(0,n.lazy)(()=>r.e(388).then(r.bind(r,8388))),q=(0,n.lazy)(()=>Promise.all([r.e(583),r.e(852)]).then(r.bind(r,1852))),D=(0,n.lazy)(()=>r.e(182).then(r.bind(r,6182))),C=(0,n.lazy)(()=>r.e(679).then(r.bind(r,679))),z=(0,n.lazy)(()=>r.e(148).then(r.bind(r,2148))),O=(0,n.lazy)(()=>r.e(372).then(r.bind(r,2372))),L=(0,n.lazy)(()=>r.e(245).then(r.bind(r,6245))),P=(0,n.lazy)(()=>r.e(604).then(r.bind(r,8604))),$=(0,n.lazy)(()=>r.e(293).then(r.bind(r,3293))),M=()=>(0,d.Y)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:(0,d.Y)("div",{className:"spinner"})}),K=function(){return(0,d.Y)(h,{children:(0,d.Y)(S,{children:(0,d.Y)(i.Kd,{children:(0,d.Y)(k,{children:(0,d.Y)(n.Suspense,{fallback:(0,d.Y)(M,{}),children:(0,d.FD)(s.BV,{children:[(0,d.Y)(s.qh,{path:"/",element:(0,d.Y)(T,{})}),(0,d.Y)(s.qh,{path:"/login",element:(0,d.Y)(w,{})}),(0,d.Y)(s.qh,{path:"/register",element:(0,d.Y)(A,{})}),(0,d.Y)(s.qh,{path:"/trials/:id",element:(0,d.Y)(I,{})}),(0,d.Y)(s.qh,{path:"/search",element:(0,d.Y)(_,{})}),(0,d.Y)(s.qh,{path:"/profile",element:(0,d.Y)(n.Suspense,{fallback:(0,d.Y)(M,{}),children:(0,d.Y)(R,{userType:"user",children:(0,d.Y)(E,{})})})}),(0,d.Y)(s.qh,{path:"/dashboard",element:(0,d.Y)(n.Suspense,{fallback:(0,d.Y)(M,{}),children:(0,d.Y)(R,{userType:"company",children:(0,d.Y)(F,{})})})}),(0,d.Y)(s.qh,{path:"/create-trial",element:(0,d.Y)(n.Suspense,{fallback:(0,d.Y)(M,{}),children:(0,d.Y)(R,{userType:"company",children:(0,d.Y)(x,{})})})}),(0,d.Y)(s.qh,{path:"/analytics",element:(0,d.Y)(n.Suspense,{fallback:(0,d.Y)(M,{}),children:(0,d.Y)(R,{userType:"company",children:(0,d.Y)(q,{})})})}),(0,d.Y)(s.qh,{path:"/subscription",element:(0,d.Y)(D,{})}),(0,d.Y)(s.qh,{path:"/about",element:(0,d.Y)(C,{})}),(0,d.Y)(s.qh,{path:"/contact",element:(0,d.Y)(z,{})}),(0,d.Y)(s.qh,{path:"/faq",element:(0,d.Y)(O,{})}),(0,d.Y)(s.qh,{path:"/terms",element:(0,d.Y)(L,{})}),(0,d.Y)(s.qh,{path:"/privacy",element:(0,d.Y)(P,{})}),(0,d.Y)(s.qh,{path:"/privacy-dashboard",element:(0,d.Y)(n.Suspense,{fallback:(0,d.Y)(M,{}),children:(0,d.Y)(R,{children:(0,d.Y)($,{})})})})]})})})})})})}},9098:(e,t,r)=>{r.d(t,{As:()=>g,B0:()=>f});var a=r(1621),n=r(7134),i=r(9710),s=r(6869);const o=e=>({user:null,loading:!0,error:null,mockMode:!1,setUser:t=>e({user:t}),setLoading:t=>e({loading:t}),setError:t=>e({error:t}),setMockMode:t=>e({mockMode:t}),login:async(t,r)=>{e({loading:!0,error:null});try{const n=await(a={email:t,password:r},s.Ay.post("/auth/login",a)),{tokens:i,user:o}=n.data;localStorage.setItem("access_token",i.access),localStorage.setItem("refresh_token",i.refresh),e({user:o,loading:!1,mockMode:!1})}catch(n){throw 0,e({error:n.message||"Login failed",loading:!1}),n}var a},register:async t=>{e({loading:!0,error:null});try{const r=await(e=>s.Ay.post("/auth/register",e))(t),{tokens:a,user:n}=r.data;localStorage.setItem("access_token",a.access),localStorage.setItem("refresh_token",a.refresh),r.data.verification_token&&localStorage.setItem("verification_token",r.data.verification_token),e({user:n,loading:!1,mockMode:!1})}catch(r){throw 0,e({error:r.message||"Registration failed",loading:!1}),r}},logout:()=>{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("verification_token"),localStorage.removeItem("mock_user"),e({user:null,loading:!1,error:null,mockMode:!1})},loadUser:async()=>{const t=localStorage.getItem("access_token");if(localStorage.getItem("mock_user"),0,!t)return e({user:null,loading:!1}),void 0;e({loading:!0});try{const t=(await s.Ay.get("/auth/me")).data;e({user:t,loading:!1,mockMode:!1})}catch(r){0,localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("mock_user"),e({user:null,loading:!1})}}});var l=r(6323);const c=(e,t)=>({notifications:[],unreadCount:0,fetchNotifications:async()=>{try{const t=(await l.n.list()).data,r=t.filter(e=>!e.is_read).length;e({notifications:t,unreadCount:r})}catch(t){void 0}},markAsRead:async r=>{const a=t().notifications,n=t().unreadCount,i=a.map(e=>e.id===r?{...e,is_read:!0}:e),s=Math.max(0,n-1);e({notifications:i,unreadCount:s});try{await l.n.markRead(r)}catch(o){throw e({notifications:a,unreadCount:n}),o}}});var d=r(1098);const h=(e,t)=>({trials:[],favoriteTrials:[],selectedIndustries:[],industries:[],loadingTrials:!1,toggleFavorite:async r=>{const{favoriteTrials:a,trials:n}=t(),i=a.includes(r),s=i?a.filter(e=>e!==r):[...a,r],o=n.map(e=>e.id===r?{...e,is_favorited:!i}:e);e({favoriteTrials:s,trials:o});try{await d.K.toggleFavorite(r)}catch(l){throw e({favoriteTrials:a,trials:n}),l}},loadFavorites:async()=>{try{const t=(await d.K.getFavorites()).data.map(e=>e.trial.id);e({favoriteTrials:t})}catch(t){1}},updateIndustries:async t=>{e({selectedIndustries:t});try{await d.K.followIndustries(t)}catch(r){throw r}},fetchTrials:async t=>{e({loadingTrials:!0});try{const r=await d.K.list(t),a=r.data.results||r.data,n=Array.isArray(a)?a:[];e({trials:n,loadingTrials:!1})}catch(r){e({trials:[],loadingTrials:!1})}},fetchIndustries:async()=>{try{const t=await d.K.getIndustries();e({industries:t.data})}catch(t){1}}}),u=e=>({sidebarOpen:!1,theme:"light",loadingStates:{},toggleSidebar:()=>e(e=>({sidebarOpen:!e.sidebarOpen})),setTheme:t=>e({theme:t}),setLoadingState:(t,r)=>{e(e=>({loadingStates:{...e.loadingStates,[t]:r}}))},clearLoadingStates:()=>e({loadingStates:{}})}),m=(0,a.vt)()((0,n.lt)((0,n.Zr)((0,n.eh)((0,i.D)((e,t)=>({...o(e),...h(e,t),...u(e),...c(e,t),clearLoadingStates:()=>e(e=>{e.loadingStates={}})}))),{name:"trialssfinder-store",partialize:e=>({user:e.user,favoriteTrials:e.favoriteTrials,selectedIndustries:e.selectedIndustries})}),{name:"TrialsFinder"})),g=()=>({user:m(e=>e.user),loading:m(e=>e.loading),mockMode:m(e=>e.mockMode),login:m(e=>e.login),register:m(e=>e.register),logout:m(e=>e.logout),loadUser:m(e=>e.loadUser)}),f=()=>({trials:m(e=>e.trials),favoriteTrials:m(e=>e.favoriteTrials),loadingTrials:m(e=>e.loadingTrials),toggleFavorite:m(e=>e.toggleFavorite),fetchTrials:m(e=>e.fetchTrials)})}}]);