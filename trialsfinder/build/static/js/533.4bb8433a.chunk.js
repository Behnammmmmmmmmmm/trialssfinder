"use strict";(self.webpackChunktrialssfinder=self.webpackChunktrialssfinder||[]).push([[533],{533:(e,t,s)=>{s.r(t),s.d(t,{SubscriptionPage:()=>m,default:()=>x});var a=s(5043),d=s(3216),i=s(4171);const n=()=>i.Ay.get("/subscriptions/payment-methods/"),r=e=>i.Ay.post("/subscriptions/payment-methods/",e),c=e=>i.Ay.delete(`/subscriptions/payment-methods/${e}/`),o=e=>i.Ay.post(`/subscriptions/payment-methods/${e}/set-default/`),l=()=>i.Ay.get("/subscriptions/"),h=e=>i.Ay.post("/subscriptions/create/",e),u=()=>i.Ay.get("/subscriptions/invoices/"),p=e=>i.Ay.post("/subscriptions/update-address/",{address:e});var y=s(579);const m=()=>{const{trialId:e}=(0,d.g)(),t=(0,d.Zp)(),[s,i]=(0,a.useState)([]),[m,x]=(0,a.useState)([]),[j,f]=(0,a.useState)([]),[_,b]=(0,a.useState)(""),[v,g]=(0,a.useState)({method_type:"credit_card",last_four:"",is_default:!1});(0,a.useEffect)(()=>{A()},[]);const A=async()=>{try{const e=await n();i(e.data);const t=await l();x(t.data);const s=await u();f(s.data)}catch(e){console.error("Failed to load subscription data:",e)}};return e?(0,y.jsxs)("div",{children:[(0,y.jsx)("h1",{children:"Payment for Trial"}),(0,y.jsx)("h3",{children:"Select Payment Method"}),s.map(s=>(0,y.jsxs)("div",{children:[(0,y.jsxs)("span",{children:[s.method_type," ending in ",s.last_four]}),(0,y.jsx)("button",{onClick:()=>(async s=>{if(e)try{await h({trial_id:parseInt(e),payment_method_id:s}),t("/payment-success")}catch(a){console.error("Payment failed:",a)}})(s.id),children:"Pay with this method"})]},s.id))]}):(0,y.jsxs)("div",{children:[(0,y.jsx)("h1",{children:"Subscription Management"}),(0,y.jsx)("h2",{children:"Your Subscriptions"}),m.map(e=>(0,y.jsxs)("div",{children:[(0,y.jsx)("h3",{children:e.trial_name}),(0,y.jsxs)("p",{children:["Amount: $",e.amount]}),(0,y.jsxs)("p",{children:["Status: ",e.status]}),(0,y.jsxs)("p",{children:["Date: ",e.created_at]})]},e.id)),(0,y.jsx)("h2",{children:"Address"}),(0,y.jsx)("input",{type:"text",value:_,onChange:e=>b(e.target.value),placeholder:"Address"}),(0,y.jsx)("button",{onClick:async()=>{try{await p(_),alert("Address updated")}catch(e){console.error("Failed to update address:",e)}},children:"Update Address"}),(0,y.jsx)("h2",{children:"Payment Methods"}),s.map(e=>(0,y.jsxs)("div",{children:[(0,y.jsxs)("span",{children:[e.method_type," ending in ",e.last_four]}),e.is_default&&(0,y.jsx)("span",{children:" (Default)"}),(0,y.jsx)("button",{onClick:()=>(async e=>{try{await o(e),A()}catch(t){console.error("Failed to set default payment method:",t)}})(e.id),children:"Make Default"}),(0,y.jsx)("button",{onClick:()=>(async e=>{try{await c(e),A()}catch(t){console.error("Failed to delete payment method:",t)}})(e.id),children:"Remove"})]},e.id)),(0,y.jsx)("h3",{children:"Add Payment Method"}),(0,y.jsxs)("select",{value:v.method_type,onChange:e=>g({...v,method_type:e.target.value}),children:[(0,y.jsx)("option",{value:"credit_card",children:"Credit Card"}),(0,y.jsx)("option",{value:"paypal",children:"PayPal"})]}),(0,y.jsx)("input",{type:"text",value:v.last_four,onChange:e=>g({...v,last_four:e.target.value}),placeholder:"Last 4 digits",maxLength:4}),(0,y.jsxs)("label",{children:[(0,y.jsx)("input",{type:"checkbox",checked:v.is_default,onChange:e=>g({...v,is_default:e.target.checked})}),"Set as default"]}),(0,y.jsx)("button",{onClick:async()=>{try{await r(v),A(),g({method_type:"credit_card",last_four:"",is_default:!1})}catch(e){console.error("Failed to add payment method:",e)}},children:"Add"}),(0,y.jsx)("h2",{children:"Invoices"}),j.map(e=>(0,y.jsxs)("div",{children:[(0,y.jsxs)("p",{children:["Amount: $",e.amount]}),(0,y.jsxs)("p",{children:["Date: ",e.created_at]})]},e.id))]})},x=m}}]);
//# sourceMappingURL=533.4bb8433a.chunk.js.map