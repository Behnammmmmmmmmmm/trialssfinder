(self.webpackChunktrialsfinder=self.webpackChunktrialsfinder||[]).push([[182],{6182:(t,e,a)=>{a.r(e),a.d(e,{SubscriptionPage:()=>c,default:()=>r});var i=a(5299),d=a(7767),n=a(6869);var s=a(2240);const c=()=>{const{trialId:t}=(0,d.g)(),e=(0,d.Zp)(),[a,c]=(0,i.useState)([]),[r,l]=(0,i.useState)([]),[o,h]=(0,i.useState)([]),[u,p]=(0,i.useState)(""),[y,m]=(0,i.useState)({method_type:"credit_card",last_four:"",is_default:!1});(0,i.useEffect)(()=>{v()},[]);const v=async()=>{try{const t=await n.Ay.get("/subscriptions/payment-methods/");c(t.data);const e=await n.Ay.get("/subscriptions/");l(e.data);const a=await n.Ay.get("/subscriptions/invoices/");h(a.data)}catch(t){void 0}};return t?(0,s.FD)("div",{children:[(0,s.Y)("h1",{children:"Payment for Trial"}),(0,s.Y)("h3",{children:"Select Payment Method"}),a.map(a=>(0,s.FD)("div",{children:[(0,s.FD)("span",{children:[a.method_type," ending in ",a.last_four]}),(0,s.Y)("button",{onClick:()=>(async a=>{if(t)try{await(i={trial_id:parseInt(t),payment_method_id:a},n.Ay.post("/subscriptions/create/",i)),e("/payment-success")}catch(d){void 0}var i})(a.id),children:"Pay with this method"})]},a.id))]}):(0,s.FD)("div",{children:[(0,s.Y)("h1",{children:"Subscription Management"}),(0,s.Y)("h2",{children:"Your Subscriptions"}),r.map(t=>(0,s.FD)("div",{children:[(0,s.Y)("h3",{children:t.trial_name}),(0,s.FD)("p",{children:["Amount: $",t.amount]}),(0,s.FD)("p",{children:["Status: ",t.status]}),(0,s.FD)("p",{children:["Date: ",t.created_at]})]},t.id)),(0,s.Y)("h2",{children:"Address"}),(0,s.Y)("input",{type:"text",value:u,onChange:t=>p(t.target.value),placeholder:"Address"}),(0,s.Y)("button",{onClick:async()=>{try{await(t=>n.Ay.post("/subscriptions/update-address/",{address:t}))(u),alert("Address updated")}catch(t){void 0}},children:"Update Address"}),(0,s.Y)("h2",{children:"Payment Methods"}),a.map(t=>(0,s.FD)("div",{children:[(0,s.FD)("span",{children:[t.method_type," ending in ",t.last_four]}),t.is_default&&(0,s.Y)("span",{children:" (Default)"}),(0,s.Y)("button",{onClick:()=>(async t=>{try{await(t=>n.Ay.post(`/subscriptions/payment-methods/${t}/set-default/`))(t),v()}catch(e){void 0}})(t.id),children:"Make Default"}),(0,s.Y)("button",{onClick:()=>(async t=>{try{await(t=>n.Ay.delete(`/subscriptions/payment-methods/${t}/`))(t),v()}catch(e){void 0}})(t.id),children:"Remove"})]},t.id)),(0,s.Y)("h3",{children:"Add Payment Method"}),(0,s.FD)("select",{value:y.method_type,onChange:t=>m({...y,method_type:t.target.value}),children:[(0,s.Y)("option",{value:"credit_card",children:"Credit Card"}),(0,s.Y)("option",{value:"paypal",children:"PayPal"})]}),(0,s.Y)("input",{type:"text",value:y.last_four,onChange:t=>m({...y,last_four:t.target.value}),placeholder:"Last 4 digits",maxLength:4}),(0,s.FD)("label",{children:[(0,s.Y)("input",{type:"checkbox",checked:y.is_default,onChange:t=>m({...y,is_default:t.target.checked})}),"Set as default"]}),(0,s.Y)("button",{onClick:async()=>{try{await(t=y,n.Ay.post("/subscriptions/payment-methods/",t)),v(),m({method_type:"credit_card",last_four:"",is_default:!1})}catch(e){void 0}var t},children:"Add"}),(0,s.Y)("h2",{children:"Invoices"}),o.map(t=>(0,s.FD)("div",{children:[(0,s.FD)("p",{children:["Amount: $",t.amount]}),(0,s.FD)("p",{children:["Date: ",t.created_at]})]},t.id))]})},r=c}}]);